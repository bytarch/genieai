(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1275],{"(app-pages-browser)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?modules=%7B%22request%22%3A%22%2Fhome%2Fbytarch%2FDocuments%2Fprojects%2Fgenie%2Fapp%2Fagent%2Fchat%2Fpage.tsx%22%2C%22ids%22%3A%5B%5D%7D&server=false!":(e,t,s)=>{Promise.resolve().then(s.bind(s,"(app-pages-browser)/./app/agent/chat/page.tsx"))},"(app-pages-browser)/./app/agent/chat/page.tsx":(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{default:()=>b});var n=s("(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-runtime.js"),o=s("(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js"),r=s("(app-pages-browser)/./node_modules/next/dist/api/navigation.js"),l=s("(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/panels-top-left.js"),i=s("(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/book-open.js"),c=s("(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/history.js"),d=s("(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/badge-plus.js"),p=s("(app-pages-browser)/./components/ui/sheet.tsx"),m=s("(app-pages-browser)/./components/ui/button.tsx"),u=s("(app-pages-browser)/./components/custom/message.tsx"),g=s("(app-pages-browser)/./components/custom/chatinput.tsx"),x=s("(app-pages-browser)/./components/custom/use-scroll-to-bottom.ts"),h=s("(app-pages-browser)/./lib/utils.ts"),w=s("(app-pages-browser)/./node_modules/sonner/dist/index.mjs"),j=e([p,m,u,g,h]);function b(){let[e,t]=(0,x.R)(),s=(0,r.useSearchParams)(),[a,j]=(0,o.useState)([]),[b,f]=(0,o.useState)(""),[y,v]=(0,o.useState)(!1),[N,k]=(0,o.useState)(!0),[F,S]=(0,o.useState)(null),_=(0,o.useRef)(null),C=s.get("id"),[A,D]=(0,o.useState)([]),[I,z]=(0,o.useState)(!0),[E,q]=(0,o.useState)(null),$=async()=>{try{z(!0);let e=await fetch("https://blacksourcellc.taile6b163.ts.net/v0/agents");if(!e.ok)throw Error("Failed to fetch agents");let t=await e.json();D(t)}catch(e){q(e instanceof Error?e.message:"Failed to load agents")}finally{z(!1)}};(0,o.useEffect)(()=>{$()},[]);let B=()=>{_.current&&(removeEventListener("message",_.current),_.current=null)},O=async()=>{if(!b.trim()||!C||y)return;f(""),v(!0),k(!1),B();let e={role:"user",content:b,id:Date.now().toString(),timestamp:new Date};j(t=>[...t,e]);let t=await (0,h.FH)(),s=sessionStorage.getItem("reply_to"),a=s?JSON.parse(s).content:null,n=b;a&&(n='Replying to: "'.concat(a,'"\n\nUser: ').concat(b));let o=(null==F?void 0:F.type)==="image"?F.content:null,r=(null==F?void 0:F.type)==="document"?F.content:null;try{let e=await fetch("https://blacksourcellc.taile6b163.ts.net/v0/agents/".concat(C,"/completions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:o?[{type:"text",text:n},{type:"image_url",image_url:{url:o}}]:r?[{type:"text",text:"Document: ".concat(r,"\n\n").concat(n)}]:n,api_key:t.apiKey})}),s=await e.json(),a={role:"assistant",content:s.response,id:Date.now().toString(),timestamp:new Date};j(e=>[...e,a])}catch(e){w.toast.error("Something went wrong."),console.error("API Error:",e),j(e=>[...e,{role:"assistant",content:"Error processing your request",id:Date.now().toString(),timestamp:new Date}])}finally{v(!1),sessionStorage.removeItem("uploadedImage"),sessionStorage.removeItem("document"),sessionStorage.removeItem("reply_to"),S(null)}};return I?(0,n.jsx)("div",{className:"flex flex-1 justify-center items-center min-h-screen",children:(0,n.jsx)("p",{children:"Loading agent..."})}):C&&A.some(e=>e.agent_id===C)?(0,n.jsxs)("div",{className:"flex flex-col min-w-0 h-dvh bg-black-to-b from-slate-950 via-slate-900 to-slate-950 text-white",children:[(0,n.jsxs)(p.cj,{children:[(0,n.jsx)(p.CG,{asChild:!0,children:(0,n.jsx)(m.$,{variant:"ghost",size:"icon",className:"fixed top-4 left-4 z-50",children:(0,n.jsx)(l.A,{className:"h-6 w-6"})})}),(0,n.jsxs)(p.h,{side:"left",className:"bg-zinc-900 border-zinc-800",children:[(0,n.jsx)(p.Fm,{children:(0,n.jsx)(p.qp,{className:"text-zinc-100",children:"Agent Chat"})}),(0,n.jsxs)("div",{className:"mt-8 space-y-2",children:[(0,n.jsxs)(m.$,{variant:"ghost",onClick:()=>window.location.href="/agent/chat?id="+C,className:"w-full justify-start text-zinc-400 hover:text-zinc-100",children:[(0,n.jsx)(i.A,{className:"mr-2 h-4 w-4"}),"New Chat"]}),(0,n.jsxs)(m.$,{variant:"ghost",onClick:()=>window.location.href="/agent/all",className:"w-full justify-start text-zinc-400 hover:text-zinc-100",children:[(0,n.jsx)(c.A,{className:"mr-2 h-4 w-4"}),"Agents"]}),(0,n.jsxs)(m.$,{variant:"ghost",onClick:()=>window.location.href="/agent",className:"w-full justify-start text-zinc-400 hover:text-zinc-100",children:[(0,n.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"Create"]})]})]})]}),(0,n.jsxs)("div",{className:"flex flex-col min-w-0 gap-6 flex-1 overflow-y-scroll pt-4 bg-black-to-b from-slate-950/80 via-slate-900/80 to-slate-950/80 backdrop-blur-sm",children:[0===a.length&&N&&!y&&(0,n.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,n.jsxs)("div",{className:"text-center space-y-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-gray-200 to-red-600 bg-clip-text text-transparent",children:C?"".concat(C," Chat"):"Agent Chat"}),(0,n.jsx)("p",{className:"text-gray-400",children:"Start a conversation with your agent"})]})}),"        ",y&&(0,n.jsxs)("div",{className:"flex justify-center items-center",children:[(0,n.jsx)("div",{className:"animate-spin border-t-2 border-gray-400 border-4 w-8 h-8 rounded-full"}),(0,n.jsx)("span",{className:"ml-2 text-gray-600",children:"Thinking..."})]}),a.map(e=>(0,n.jsx)(u.e,{message:e},e.id)),y&&(0,n.jsx)(u.q,{}),(0,n.jsx)("div",{ref:t,className:"shrink-0 min-w-[24px] min-h-[24px]"})]}),(0,n.jsx)("div",{className:"flex mx-auto px-4 bg-background pb-4 md:pb-6 gap-2 w-full md:max-w-3xl",children:(0,n.jsx)(g.V,{question:b,setQuestion:f,onSubmit:O,isLoading:y,onFileUpload:(e,t)=>{sessionStorage.setItem("image"===e?"uploadedImage":"document",t),S({type:e,content:t})},onFileRemove:()=>{sessionStorage.removeItem("uploadedImage"),sessionStorage.removeItem("document"),S(null)}})})]}):(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen space-y-4 p-4 text-center",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Agent Not Found"}),(0,n.jsxs)("p",{children:["The agent you are looking for does not exist.",(0,n.jsx)("br",{}),"Would you like to create it?"]}),(0,n.jsxs)("div",{className:"flex gap-4",children:[(0,n.jsx)(m.$,{onClick:()=>window.location.href="/agent",children:"Yes"}),(0,n.jsx)(m.$,{variant:"outline",onClick:()=>window.location.href="/agent/all",children:"No"})]})]})}[p,m,u,g,h]=j.then?(await j)():j,a()}catch(e){a(e)}})},"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/badge-plus.js":(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s("(app-pages-browser)/./node_modules/lucide-react/dist/esm/createLucideIcon.js").A)("BadgePlus",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["line",{x1:"12",x2:"12",y1:"8",y2:"16",key:"10p56q"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[9268,7330,8873,3171,6047,5745,1714,3015,9895,5907,7731,9710,7074,5925,9673,8441,1517,7358],()=>t("(app-pages-browser)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?modules=%7B%22request%22%3A%22%2Fhome%2Fbytarch%2FDocuments%2Fprojects%2Fgenie%2Fapp%2Fagent%2Fchat%2Fpage.tsx%22%2C%22ids%22%3A%5B%5D%7D&server=false!")),_N_E=e.O()}]);