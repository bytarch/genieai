(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9447],{"?599d":()=>{},"?2ec2":()=>{},"?5478":()=>{},"(app-pages-browser)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?modules=%7B%22request%22%3A%22%2Fhome%2Fbytarch%2FDocuments%2Fprojects%2Fgenie%2Fcomponents%2Fpages%2Fpowerpoint%2Fpresentation.tsx%22%2C%22ids%22%3A%5B%22default%22%5D%7D&server=false!":(e,t,r)=>{Promise.resolve().then(r.bind(r,"(app-pages-browser)/./components/pages/powerpoint/presentation.tsx"))},"(app-pages-browser)/./components/pages/powerpoint/presentation.tsx":(e,t,r)=>{"use strict";r.a(e,async(e,n)=>{try{r.d(t,{default:()=>p});var a=r("(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-runtime.js"),o=r("(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js"),s=r("(app-pages-browser)/./node_modules/react-icons/fi/index.mjs"),l=r("(app-pages-browser)/./node_modules/pptxgenjs/dist/pptxgen.es.js"),i=r("(app-pages-browser)/./lib/utils.ts"),c=e([i]);function p(){let[e,t]=(0,o.useState)("Untitled Presentation"),[r,n]=(0,o.useState)(""),[c,p]=(0,o.useState)([]),[d,m]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let e=localStorage.getItem("presentation-data");if(e){let{title:r,slides:n}=JSON.parse(e);t(r),p(n)}},[]),(0,o.useEffect)(()=>{localStorage.setItem("presentation-data",JSON.stringify({title:e,slides:c}))},[c,e]);let u=async e=>{try{let t=await fetch("https://blacksourcellc.taile6b163.ts.net/v1/v2/ai/bylearn/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"auth.sessionToken ".concat(i.c7)},body:JSON.stringify({model:"OO::fine_detail",messages:[{role:"user",content:e}],stream:!1,max_tokens:500})}),r=(await t.json()).response.match(/!\[.*?\]\((.*?)\)/);return r&&r[1]?r[1]:null}catch(e){return console.error("Error generating image:",e),null}},g=async()=>{m(!0);try{var t;let n=await fetch("https://blacksourcellc.taile6b163.ts.net/v1/v2/ai/bylearn/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"auth.sessionToken ".concat(i.c7)},body:JSON.stringify({model:"501::llama-3.3-70b",messages:[{role:"system",content:'Analyze the topic and provide:\n            1. Key concepts with explanations\n            2. 5-7 image prompts for diagram/illustration\n            Format: Content followed by "IMAGEPROMPTS:" then comma-separated prompts\n            Example: "...content... IMAGEPROMPTS: prompt1, prompt2, prompt3"'},{role:"user",content:r}],stream:!1,max_tokens:1600})}),[a,o]=(await n.json()).response.split("IMAGEPROMPTS:"),s=(null==o?void 0:o.split(",").map(e=>e.trim()).filter(e=>e))||[],l=await Promise.all(s.map(async e=>{try{let t=await u(e);return{prompt:e,url:t}}catch(t){return console.error("Failed to generate image for prompt: ".concat(e),t),null}})),c=await fetch("https://blacksourcellc.taile6b163.ts.net/pptx/generator",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"auth.sessionToken ".concat(i.c7)},body:JSON.stringify({messages:[{role:"system",content:'Generate slides in this exact JSON format:\n            {\n              "slides": [\n                {\n                  "title": "Slide Title",\n                  "content": "Bullet points\\n- Point 1\\n- Point 2",\n                  "image": "index" // Use index of relevant image (0-based)\n                }\n              ]\n            }\n              Rules:\n  1. First slide: Title only (no content or image)\n  2. Last slide: Conclusion only (no image)\n  3. Middle slides: Content + 1 image each\n  4. Image indexes must match generated image order\n  5. Content must use "\\n" for line breaks'},{role:"user",content:"TITLE: ".concat(e,"\nCONTENT: ").concat(a,"\nIMAGES: ").concat(l.map(e=>null==e?void 0:e.prompt).join(", "))}]})}),d=await c.json();if(!d.success||!(null===(t=d.data)||void 0===t?void 0:t.slides))throw Error("Invalid response format from PPTX generator");let m=d.data.slides.map((e,t)=>{var r;let n=t>0&&t<d.data.slides.length-1,a=n?e.image:null,o=n&&(null===(r=l[a])||void 0===r?void 0:r.url);return{title:e.title,content:e.content,image:o?l[a].url:null}});p(m)}catch(e){console.error("Error generating slides:",e)}finally{m(!1)}};return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-800 text-white p-4",children:[(0,a.jsx)("h1",{className:"text-2xl mb-4",children:"PowerPoint Generator"}),(0,a.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),className:"mb-2 p-2 rounded bg-gray-700 text-white w-full max-w-md",placeholder:"Presentation Title"}),(0,a.jsx)("input",{type:"text",value:r,onChange:e=>n(e.target.value),className:"mb-2 p-2 rounded bg-gray-700 text-white w-full max-w-md",placeholder:"Enter topic for slides"}),(0,a.jsx)("button",{onClick:g,disabled:d,className:"mb-4 px-4 py-2 rounded ".concat(d?"bg-gray-600 cursor-not-allowed":"bg-blue-600 hover:bg-blue-500"),children:d?"Generating...":"Generate Slides"}),(0,a.jsxs)("button",{onClick:()=>{let t=new l.A;t.author="Presentation App User",t.defineSlideMaster({title:"MASTER_SLIDE",background:{color:"FFFFFF"},objects:[{rect:{x:0,y:6.9,w:"100%",h:.6,fill:{color:"2D3E50"}}}]}),c.forEach((e,r)=>{let n=t.addSlide({masterName:"MASTER_SLIDE"});if(n.addText(e.title,{x:.5,y:.5,w:"90%",h:1,fontSize:28,bold:!0,color:"2D3E50",align:"center",margin:.1}),e.content){let t=!!e.image,r=t?5.5:8.5,a=e.content.split("\n").filter(e=>e.trim()).map((e,t)=>{let r=!e.startsWith("- ")&&0===t;return{text:e.replace("- ",""),options:{bullet:e.startsWith("- "),indent:e.startsWith("- ")?.5:0,fontSize:r?20:18,bold:r,color:r?"2D3E50":"4F5F6F",lineSpacing:14,margin:{top:0===t?0:8}}}});n.addText(a,{x:.7,y:1.8,w:r,h:4.5,align:"left",valign:"top"}),t&&n.addImage({path:e.image,x:r+1,y:1.8,w:3.5,h:4.5,sizing:{type:"contain"}})}n.addText("Slide ".concat(r+1),{x:"95%",y:"93%",w:1.5,h:.4,fontSize:12,color:"FFFFFF",align:"right"})}),t.writeFile({fileName:"".concat(e.replace(/[^a-z0-9]/gi,"_"),".pptx")})},className:"flex items-center gap-2 px-4 py-2 bg-green-600 rounded hover:bg-green-500",children:[(0,a.jsx)(s.a4x,{className:"w-5 h-5"}),"Download PPTX"]}),c.length>0&&(0,a.jsxs)("div",{className:"mt-4 w-full max-w-2xl",children:[(0,a.jsx)("h2",{className:"text-xl mb-2",children:"Preview of Slides"}),(0,a.jsx)("div",{className:"bg-gray-700 p-4 rounded",children:c.map((e,t)=>(0,a.jsxs)("div",{className:"mb-4 p-4 bg-gray-600 rounded",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-2",children:e.title}),(0,a.jsx)("p",{className:"whitespace-pre-line",children:e.content}),e.image&&(0,a.jsxs)("div",{className:"mt-2 p-2 bg-gray-800 rounded",children:[(0,a.jsx)("img",{src:e.image,alt:"Generated content",className:"max-w-full h-32 object-contain"}),(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:"Image Preview"})]})]},t))})]})]})}i=(c.then?(await c)():c)[0],n()}catch(e){n(e)}})},"(app-pages-browser)/./lib/encrypt.tsx":(e,t,r)=>{"use strict";r.d(t,{Ui:()=>i,WY:()=>p,mj:()=>c});var n=r("(app-pages-browser)/./node_modules/crypto-js/index.js"),a=r.n(n);let o="123slatt",s=e=>a().AES.encrypt(e,o).toString(),l=e=>a().AES.decrypt(e,o).toString(a().enc.Utf8),i=e=>{try{let t=s(e);localStorage.setItem("accessToken",t)}catch(e){console.error("Failed to store token",e)}},c=()=>{try{let e=localStorage.getItem("accessToken");return e?l(e):null}catch(e){return console.error("Failed to retrieve token",e),null}},p=()=>{localStorage.removeItem("accessToken")}},"(app-pages-browser)/./lib/utils.ts":(e,t,r)=>{"use strict";r.a(e,async(e,n)=>{try{r.d(t,{FH:()=>m,O5:()=>y,QM:()=>b,YS:()=>f,_w:()=>g,aS:()=>e,c7:()=>w,cn:()=>d,dE:()=>u,lk:()=>x,sr:()=>h});var a=r("(app-pages-browser)/./node_modules/clsx/dist/clsx.mjs"),o=r("(app-pages-browser)/./node_modules/tailwind-merge/dist/bundle-mjs.mjs"),s=r("(app-pages-browser)/./node_modules/jsonwebtoken/index.js"),l=r.n(s),i=r("(app-pages-browser)/./lib/encrypt.tsx"),c=r("(app-pages-browser)/./node_modules/sonner/dist/index.mjs"),p=r("(app-pages-browser)/./node_modules/uuid/dist/esm-browser/v4.js");function d(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.QP)((0,a.$)(t))}let e=(0,i.mj)(),b=e=>{let t=new Date,r=new Date(e),n=Math.floor((t.getTime()-r.getTime())/1e3),a=604800,o=2592e3,s=31536e3;if(n<60)return"".concat(n," seconds ago");if(n<3600){let e=Math.floor(n/60);return"".concat(e," min").concat(e>1?"s":""," ago")}if(n<86400){let e=Math.floor(n/3600);return"".concat(e," hour").concat(e>1?"s":""," ago")}if(n<a){let e=Math.floor(n/86400);return"".concat(e," day").concat(e>1?"s":""," ago")}if(n<o){let e=Math.floor(n/a);return"".concat(e," week").concat(e>1?"s":""," ago")}if(n<s){let e=Math.floor(n/o);return"".concat(e," month").concat(e>1?"s":""," ago")}{let e=Math.floor(n/s);return"".concat(e," year").concat(e>1?"s":""," ago")}},f=e=>new Date(e).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}),h=()=>{let e=[{light:"from-blue-200 via-blue-500 to-blue-200",dark:"from-blue-400 via-blue-500 to-blue-700"},{light:"from-green-200 via-emerald-500 to-green-200",dark:"from-green-400 via-emerald-500 to-green-700"},{light:"from-purple-200 via-violet-500 to-purple-200",dark:"from-purple-400 via-violet-500 to-purple-700"},{light:"from-teal-200 via-cyan-500 to-teal-200",dark:"from-teal-400 via-cyan-500 to-teal-700"},{light:"from-rose-200 via-pink-500 to-rose-200",dark:"from-rose-400 via-pink-500 to-rose-700"}];return e[Math.floor(Math.random()*e.length)]};async function m(){try{let e=(0,i.mj)();return e||console.error("Access Token not found!"),l().decode(e,"bytarch40269erin4l").userInfo}catch(e){return console.error("Error in verifyUser:",e),null}}function u(){c.toast.info("This feature is coming soon")}let y=e=>{let t=e.replace(/\\\[([^\]]+)\\\]/g,"$$\n$1\n$$").replace(/\\\(([^)]+)\\\)/g,"$\n$1\n$").replace(/\\begin{equation}([\s\S]*?)\\end{equation}/g,"$$\n$1\n$$").replace(/\\text{([^}]+)}/g,"\\text{$1}").replace(/\\mathbb{([^}]+)}/g,"\\mathbb{$1}").replace(/\\mathcal{([^}]+)}/g,"\\mathcal{$1}").replace(/\\left\(/g,"(").replace(/\\right\)/g,")").replace(/\\dfrac{([^}]+)}{([^}]+)}/g,"\\frac{$1}{$2}");return t=t.replace(/\b([a-zA-Z]+\s*\([^)]*\)|\d+\s*[+\-*/]\s*\d+|\b[a-zA-Z]\s*=\s*[^,\n]+)/g,e=>/\$.*\$/.test(e)?e:(e.includes("=")||e.includes("(")||/[+\-*/]/.test(e),"$".concat(e,"$"))),[/\b(sin|cos|tan|cot|sec|csc|arcsin|arccos|arctan)\s*\([^)]+\)/gi,/\b(log|ln|exp)\s*\([^)]+\)/gi,/\b(d\/d[a-zA-Z]|derivative|integral)\s*[^\n,]+/gi,/\b(α|β|γ|δ|ε|ζ|η|θ|λ|μ|π|σ|τ|φ|ψ|ω)\b/g,/\b(Σ|∑|Π|∏)\s*[^\n,]+/g].forEach(e=>{t=t.replace(e,e=>/\$.*\$/.test(e)?e:e.length>20?"$$".concat(e,"$$"):"$".concat(e,"$"))}),t};function g(e){return e.replace(/\x1b\[([0-9]{1,2}(;[0-9]{1,2})*)?[m|K]/g,"")}let x=()=>(0,p.A)().toString(),w=await (0,i.mj)();n()}catch(e){n(e)}},1)},"(app-pages-browser)/./node_modules/react-icons/lib/index.mjs":(e,t,r)=>{"use strict";r.d(t,{k5:()=>p});var n=r("(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js"),a={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},o=n.createContext&&n.createContext(a),s=["attr","size","title"];function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){var n,a;n=t,a=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function p(e){return t=>n.createElement(d,l({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,r)=>n.createElement(t.tag,c({key:r},t.attr),e(t.child)))}(e.child))}function d(e){var t=t=>{var r,{attr:a,size:o,title:i}=e,p=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,s),d=o||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),n.createElement("svg",l({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,p,{className:r,style:c(c({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),i&&n.createElement("title",null,i),e.children)};return void 0!==o?n.createElement(o.Consumer,null,e=>t(e)):t(a)}}},e=>{var t=t=>e(e.s=t);e.O(0,[9268,844,6520,3171,670,8441,1517,7358],()=>t("(app-pages-browser)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?modules=%7B%22request%22%3A%22%2Fhome%2Fbytarch%2FDocuments%2Fprojects%2Fgenie%2Fcomponents%2Fpages%2Fpowerpoint%2Fpresentation.tsx%22%2C%22ids%22%3A%5B%22default%22%5D%7D&server=false!")),_N_E=e.O()}]);